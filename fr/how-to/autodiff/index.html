<!doctype html><html lang=fr class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.58.3"><meta name=description content="Gorgonia: Deep learning for Go - Write and evaluate mathematical equations involving multidimensional arrays (tensors) easily - this is the reference website with tutorials and howtos"><meta name=author content="The Gorgonia Authors"><link rel="shortcut icon" href=/images/favicon.png type=image/png><title>Comment calculer le gradient (dérivation) :: Gorgonia</title><link href=/css/nucleus.css?1677767295 rel=stylesheet><link href=/css/fontawesome-all.min.css?1677767295 rel=stylesheet><link href=/css/hybrid.css?1677767295 rel=stylesheet><link href=/css/featherlight.min.css?1677767295 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1677767295 rel=stylesheet><link href=/css/auto-complete.css?1677767295 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1677767295 rel=stylesheet><link href=/css/theme.css?1677767295 rel=stylesheet><link href=/css/hugo-theme.css?1677767295 rel=stylesheet><link href=/css/theme-gorgonia.css?1677767295 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1677767295></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><meta property=og:title content="Comment calculer le gradient (dérivation)"><meta property=og:description content="Objectif Prenez cette équation simple :
$$ f(x,y,z) = ( x &#43; y ) \times z $$
L&rsquo;objectif de cet article est de vous montrer comment Gorgonia peut évaluer le gradient $\nabla f$ avec ses dérivées partielles :
$$ \nabla f = [\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z}] $$
Explication En utilisant la règle de dérivation d&rsquo;une fonction composée, on peut obtenir la valeur du gradient à chaque étape comme démontré ici :"><meta property=og:type content=article><meta property=og:url content=https://gorgonia.org/fr/how-to/autodiff/><meta property=og:image content=https://gorgonia.org/images/opengraph.png><meta property=article:published_time content=2019-10-29T20:07:07+01:00><meta property=article:modified_time content=2019-10-29T20:07:07+01:00><meta property=og:site_name content=Gorgonia><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://gorgonia.org/images/opengraph.png><meta name=twitter:title content="Comment calculer le gradient (dérivation)"><meta name=twitter:description content="Objectif Prenez cette équation simple :
$$ f(x,y,z) = ( x &#43; y ) \times z $$
L&rsquo;objectif de cet article est de vous montrer comment Gorgonia peut évaluer le gradient $\nabla f$ avec ses dérivées partielles :
$$ \nabla f = [\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z}] $$
Explication En utilisant la règle de dérivation d&rsquo;une fonction composée, on peut obtenir la valeur du gradient à chaque étape comme démontré ici :"></head><body data-url=/fr/how-to/autodiff/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://gorgonia.org/><img src=https://gorgonia.org/images/logo/gorgonia.svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Rechercher...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1677767295></script><script type=text/javascript src=/js/auto-complete.js?1677767295></script><script type=text/javascript>var baseurl="https:\/\/gorgonia.org\/\/fr";</script><script type=text/javascript src=/js/search.js?1677767295></script><ul><li><a class=padding><em class="fas fa-language fa-fw"></em><div class=select-style><select id=select-language onchange="location=this.value;">
<option id=en value=https://gorgonia.org/how-to/autodiff/>English</option>
<option id=fr value=https://gorgonia.org/fr/how-to/autodiff/ selected>Français</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><path d="M0 63.75l127.5 127.5L255 63.75z" /></g></g></svg></div></a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/fr/getting-started/ title="Premiers pas" class=dd-item><a href=/fr/getting-started/>Premiers pas
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/fr/getting-started/ubiquitous-language/ title="Language dédié et glossaire" class=dd-item><a href=/fr/getting-started/ubiquitous-language/>Language dédié et glossaire
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/getting-started/contributing-doc/ title="Commencer à contribuer à la documentation" class=dd-item><a href=/fr/getting-started/contributing-doc/>Commencer à contribuer à la documentation
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/fr/about/ title="Fonctionnement de Gorgonia" class=dd-item><a href=/fr/about/>Fonctionnement de Gorgonia
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/tutorials/ title=Tutoriels class=dd-item><a href=/fr/tutorials/>Tutoriels
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/fr/tutorials/hello-world/ title="Hello World" class=dd-item><a href=/fr/tutorials/hello-world/>Hello World
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/tutorials/iris/ title="Régression linéaire multivariée sur le dataset Iris" class=dd-item><a href=/fr/tutorials/iris/>Régression linéaire multivariée sur le dataset Iris
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/fr/how-to/ title="Guide pratique" class="dd-item
        parent"><a href=/fr/how-to/>Guide pratique
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/fr/how-to/troubleshoot-gpu-issues/ title="Résoudre des problèmes de GPU" class=dd-item><a href=/fr/how-to/troubleshoot-gpu-issues/>Résoudre des problèmes de GPU
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/how-to/dot/ title="Dessiner le ExprGraph avec Graphviz (dot)" class=dd-item><a href=/fr/how-to/dot/>Dessiner le ExprGraph avec Graphviz (dot)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/how-to/dataframe/ title="Créer un tensor depuis un Dataframe (gota)" class=dd-item><a href=/fr/how-to/dataframe/>Créer un tensor depuis un Dataframe (gota)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/how-to/save-weights/ title="Sauver les matrices de poids" class=dd-item><a href=/fr/how-to/save-weights/>Sauver les matrices de poids
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/how-to/autodiff/ title="Comment calculer le gradient (dérivation)" class="dd-item active"><a href=/fr/how-to/autodiff/>Comment calculer le gradient (dérivation)
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/fr/reference/ title=References class=dd-item><a href=/fr/reference/>References
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/fr/reference/exprgraph/ title="Graph / Exprgraph" class=dd-item><a href=/fr/reference/exprgraph/>Graph / Exprgraph
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/fr/reference/vm/gomachine/ title="Go Machine" class=dd-item><a href=/fr/reference/vm/gomachine/>Go Machine
<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><section id=shortcuts><h3>Aller plus loin</h3><ul><li><a class=padding href=https://github.com/gorgonia/gorgonia><i class="fab fa-fw fa-github"></i>Repo GitHub</a></li><li><a class=padding href="https://pkg.go.dev/gorgonia.org/gorgonia?tab=doc"><i class="fas fa-fw fa-bookmark"></i>API Doc</a></li><li><a class=padding href=http://gophers.slack.com/messages/gorgonia><i class="fab fa-fw fa-slack"></i>Contact us</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i>Supprimer l&#39;historique</a></li></ul></section><section id=footer><center><a class=github-button href=https://github.com/gorgonia/gorgonia data-icon=octicon-star data-show-count=true aria-label="Star gorgonia/gorgonia on GitHub">Star</a><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></center><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Modifier la page" href=https://github.com/gorgonia/gorgonia.github.io/edit/develop/content/how-to/autodiff.fr.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Modifier la page</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/fr/>Gorgonia</a> > <a href=/fr/how-to/>Guide pratique</a> > Comment calculer le gradient (dérivation)</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#objectif>Objectif</a><ul><li><a href=#explication>Explication</a></li></ul></li><li><a href=#créer-l-équation>Créer l&rsquo;équation</a><ul><li><a href=#obtenir-les-gradients>Obtenir les gradients</a><ul><li><a href=#dérivation-automatique>Dérivation automatique</a></li><li><a href=#calcul-symbolique>Calcul symbolique</a></li></ul></li></ul></li><li><a href=#full-code-dérivation-automatique>Full Code (Dérivation automatique)</a></li><li><a href=#full-code-calcul-symbolique>Full Code (Calcul symbolique)</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Comment calculer le gradient (dérivation)</h1><h2 id=objectif>Objectif</h2><p>Prenez cette équation simple :</p><p>$$ f(x,y,z) = ( x + y ) \times z $$</p><p>L&rsquo;objectif de cet article est de vous montrer comment Gorgonia peut évaluer le gradient $\nabla f$ avec ses dérivées partielles :</p><p>$$ \nabla f = [\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z}] $$</p><h3 id=explication>Explication</h3><p>En utilisant la <a href=https://www.khanacademy.org/math/ap-calculus-ab/ab-differentiation-2-new/ab-3-1a/a/chain-rule-review>règle de dérivation d&rsquo;une fonction composée</a>, on peut obtenir la valeur du gradient à chaque étape comme démontré ici :</p><div class=mermaid align=left>graph LR;
x -->|$x=-2$<br>$\partial f/\partial x = -4$| add
y -->|$y=5$<br>$\partial f/\partial y = -4$| add
add(+) -->|$q=3$<br>$\partial f/\partial q = -4$| mul
z -->|$z=-4$<br>$\partial f/\partial z = 3$| mul
mul(*) -->|$f=-12$<br>$1$| f</div><div class="notices info"><p>Pour plus d&rsquo;informations sur le calcul de gradient, veuillez lire cet <a href=http://cs231n.github.io/optimization-2/>article de cs231n (en anglais)</a> de Stanford.</p></div><p>Nous allons représenter cette équation dans un <a href=/reference/exprgraph>exprgraph</a> et voir comment demander à Gorgonia de calculer le gradient.</p><p>Quand le calcul est effectué, chaque point aura une <a href=/reference/dualvalue>double valeur</a> qui contiendra à la fois sa valeur réelle et la dérivée wrt de x.</p><p>par exemple, prenons le point x :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Node</span></code></pre></div><p>Une fois que Gorgonia a évalué l&rsquo;exprgraph, il est possible d&rsquo;extraire la valeur de <code>x</code> aet la valeur du gradient $\frac{\partial f}{\partial x}$ en appelant :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>xValue</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>()</span>    <span style=color:#8f5902;font-style:italic>// -2
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>dfdx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>_</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>()</span>    <span style=color:#ce5c00;font-weight:700>//</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>please</span> <span style=color:#000>check</span> <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>errors</span> <span style=color:#000>in</span> <span style=color:#000>proper</span> <span style=color:#000>code</span></code></pre></div><p>Voyons comment faire cela.</p><h2 id=créer-l-équation>Créer l&rsquo;équation</h2><p>D&rsquo;abord, créons l&rsquo;<a href=/reference/exprgraph>exprgraph</a> qui représente l&rsquo;équation.</p><div class="notices info"><p>Si vous voulez plus d&rsquo;infos sur cette partie, veuillez lire le tutoriel <a href=/tutorials/hello-world/>hello world</a>.</p></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewGraph</span><span style=color:#000;font-weight:700>()</span>

<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>z</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Node</span>
<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>

<span style=color:#8f5902;font-style:italic>// define the expression
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>x</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;x&#34;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>y</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;y&#34;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>z</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;z&#34;</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000>q</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
<span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Mul</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>q</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><p>Et définissez quelques valeurs :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>2.0</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5.0</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>4.0</span><span style=color:#000;font-weight:700>)</span></code></pre></div><h3 id=obtenir-les-gradients>Obtenir les gradients</h3><p>Il y a deux manières d&rsquo;obtenir les gradients :</p><ul><li>en utilisant la compétence de <a href=https://fr.wikipedia.org/wiki/D%C3%A9rivation_automatique>dérivation automatique</a> de la <a href=/reference/lispmachine>LispMachine</a>;</li><li>en utilisant la compétence de <a href=https://fr.wikipedia.org/wiki/Calcul_formel>calcul symbolique</a> proposée par Gorgonia;</li></ul><h4 id=dérivation-automatique>Dérivation automatique</h4><p>La dérivation automatique n&rsquo;est possible qu&rsquo;avec la <a href=/reference/lispmachine>LispMachine</a>.
Par défaut, lispmachine fonctionne avec des mode d&rsquo;exécution en avant et en arrière.</p><p>Ainsi, utiliser la méthode RunAll suffit pour obtenir le résultat.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewLispMachine</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RunAll</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><p>Les valeurs et gradients peuvent à présent être extraites :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;x=%v;y=%v;z=%v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
<span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;f(x,y,z) = %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>result</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>

<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;df/dx: %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;df/dy: %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;df/dx: %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><h4 id=calcul-symbolique>Calcul symbolique</h4><p>Une autre option est d&rsquo;utiliser le calcul symbolique.
Le calcul symbolique fonctionne en ajoutant des points aux graphiques. Ces nouveaux points contiennent les gradients par rapport aux nœuds passés en argument.</p><p>Pour créer ces nouveaux points, on utilise la fonction <a href=https://godoc.org/gorgonia.org/gorgonia#Grad>Grad()</a>.</p><p>Grad prend un point de coût scalaire et une liste de ce qui concerne, et renvoie le gradient.</p><p>Prenez le code suivant :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>grads</span> <span style=color:#000>Nodes</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>Grad</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><p>Cela signifie qu&rsquo;il faut calculer les dérivées partielles (gradients) par rapport à <code>z</code>, <code>x</code> et <code>y</code>.</p><p><code>grads</code> dans un tableau de <code>[]*gorgonia.Node</code>, dans le même ordre que les WRTs qui y sont passés :</p><ul><li><code>grads[0]</code> = $\frac{\partial f}{\partial z}$</li><li><code>grads[1]</code> = $\frac{\partial f}{\partial x}$</li><li><code>grads[2]</code> = $\frac{\partial f}{\partial y}$</li></ul><p>Le gradient est compatible avec <a href=/reference/tapemachine>TapeMachine</a> et <a href=/reference/lispmachine>LispMachine</a>. Mais TapeMachine est beaucoup plus rapide.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>machine</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewTapeMachine</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>machine</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>machine</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RunAll</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;result: %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>result</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>zgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;dz/dx: %v | %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>zgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;dz/dx: %v | %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;dz/dy: %v | %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><p>Notez que vous pouvez accéder aux dérivées partielles de deux manières :</p><ol><li>En utlisant la méthode <code>.Grad()</code> par exemple pour le gradient de <code>x</code> dans l&rsquo;exemple présent, utilisez <code>x.Grad()</code></li><li>En utlisant la méthode <code>.Value()</code> du point gradient par exemple pour le gradient de <code>x</code> de l&rsquo;exemple, utilisez <code>grads[1].Value()</code>.</li></ol><p>La raison d&rsquo;avoir ces deux manières différentes de faire les choses se résume à la pertinence. Lorsqu&rsquo;il est plus significatif d&rsquo;obtenir des valeurs à partir des points de gradient (par exemple, vous pouvez vouloir calculer la dérivée seconde), utilisez les nœuds de gradient. Mais si vous voulez une récupération rapide des valeurs de gradient, la méthode <code>.Grad()</code> pourrait être la plus appropriée. En fin de compte, cela dépend de votre goût.</p><h2 id=full-code-dérivation-automatique>Full Code (Dérivation automatique)</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
 <span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewGraph</span><span style=color:#000;font-weight:700>()</span>

 <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>z</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Node</span>
 <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>

 <span style=color:#8f5902;font-style:italic>// define the expression
</span><span style=color:#8f5902;font-style:italic></span> <span style=color:#000>x</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;x&#34;</span><span style=color:#000;font-weight:700>))</span>
 <span style=color:#000>y</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;y&#34;</span><span style=color:#000;font-weight:700>))</span>
 <span style=color:#000>z</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;z&#34;</span><span style=color:#000;font-weight:700>))</span>
 <span style=color:#000>q</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>
 <span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Mul</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>q</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#8f5902;font-style:italic>// set initial values then run
</span><span style=color:#8f5902;font-style:italic></span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>2.0</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5.0</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>4.0</span><span style=color:#000;font-weight:700>)</span>

 <span style=color:#8f5902;font-style:italic>// by default, lispmachine performs forward mode and backwards mode execution
</span><span style=color:#8f5902;font-style:italic></span> <span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewLispMachine</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RunAll</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;x=%v;y=%v;z=%v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
 <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;f(x,y,z)=(x+y)*z\n&#34;</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;f(x,y,z) = %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>result</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>

 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;df/dx: %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;df/dy: %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>
 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;df/dz: %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><p>qui donne :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>$ go run main.go
x=-2;y=5;z=-4
f(x,y,z)=(x+y)*z
f(x,y,z) = -12
df/dx: -4
df/dy: -4
df/dz: 3</code></pre></div><h2 id=full-code-calcul-symbolique>Full Code (Calcul symbolique)</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
 <span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewGraph</span><span style=color:#000;font-weight:700>()</span>

 <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>z</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Node</span>
 <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>

 <span style=color:#8f5902;font-style:italic>// define the expression
</span><span style=color:#8f5902;font-style:italic></span> <span style=color:#000>x</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;x&#34;</span><span style=color:#000;font-weight:700>))</span>
 <span style=color:#000>y</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;y&#34;</span><span style=color:#000;font-weight:700>))</span>
 <span style=color:#000>z</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewScalar</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Float64</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;z&#34;</span><span style=color:#000;font-weight:700>))</span>
 <span style=color:#000>q</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Add</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>
 <span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Mul</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>q</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>Grad</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#8f5902;font-style:italic>// set initial values then run
</span><span style=color:#8f5902;font-style:italic></span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>2.0</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>y</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5.0</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Let</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>z</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>4.0</span><span style=color:#000;font-weight:700>)</span>

 <span style=color:#000>machine</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gorgonia</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewTapeMachine</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>machine</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>machine</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RunAll</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;x=%v;y=%v;z=%v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
 <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;f(x,y,z)=(x+y)*z\n&#34;</span><span style=color:#000;font-weight:700>)</span>
 <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;f(x,y,z) = %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>result</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>

 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>zgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>z</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;dz/dx: %v | %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>zgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;dz/dx: %v | %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>xgrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
 <span style=color:#000;font-weight:700>}</span>

 <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>y</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Grad</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;dz/dy: %v | %v\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ygrad</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>grads</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>Value</span><span style=color:#000;font-weight:700>())</span>
 <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><p>qui donne :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>$ go run main.go
x=-2;y=5;z=-4
f(x,y,z)=(x+y)*z
f(x,y,z) = -12
df/dx: -4 | -4
df/dy: -4 | -4
df/dz: 3 | 3</code></pre></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/fr/how-to/save-weights/ title="Sauver les matrices de poids"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/fr/reference/ title=References style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1677767295></script><script src=/js/perfect-scrollbar.min.js?1677767295></script><script src=/js/perfect-scrollbar.jquery.min.js?1677767295></script><script src=/js/jquery.sticky.js?1677767295></script><script src=/js/featherlight.min.js?1677767295></script><script src=/js/modernizr.custom-3.6.0.js?1677767295></script><script src=/js/learn.js?1677767295></script><script src=/js/hugo-learn.js?1677767295></script><link href=/mermaid/mermaid.css?1677767295 rel=stylesheet><script src=/mermaid/mermaid.js?1677767295></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>