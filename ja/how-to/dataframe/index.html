<!doctype html><html lang=ja class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.58.3"><meta name=description content="Gorgonia: Deep learning for Go - Write and evaluate mathematical equations involving multidimensional arrays (tensors) easily - this is the reference website with tutorials and howtos"><meta name=author content="The Gorgonia Authors"><link rel="shortcut icon" href=/images/favicon.png type=image/png><title>データフレームからテンソルを作成 (gota) :: Gorgonia</title><link href=/css/nucleus.css?1677767296 rel=stylesheet><link href=/css/fontawesome-all.min.css?1677767296 rel=stylesheet><link href=/css/hybrid.css?1677767296 rel=stylesheet><link href=/css/featherlight.min.css?1677767296 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1677767296 rel=stylesheet><link href=/css/auto-complete.css?1677767296 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1677767296 rel=stylesheet><link href=/css/theme.css?1677767296 rel=stylesheet><link href=/css/hugo-theme.css?1677767296 rel=stylesheet><link href=/css/theme-gorgonia.css?1677767296 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1677767296></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><meta property=og:title content="データフレームからテンソルを作成 (gota)"><meta property=og:description content='このハウツーでは、gotaを使用してデータフレームからテンソルを作成する方法を説明します。 The goal is to read a csv file and create a *tensor.Dense with shape (2,2). ゴールは、csvファイルを読み取り、(2,2) のシェイプの* tensor.Denseを作成することです。
csvファイルからデータフレームを作成する 以下のコンテンツのcsvファイルを考えます:
sepal_length,sepal_width,petal_length,petal_width,species 5.1 ,3.5 ,1.4 ,0.2 ,setosa 4.9 ,3.0 ,1.4 ,0.2 ,setosa 4.7 ,3.2 ,1.3 ,0.2 ,setosa 4.6 ,3.1 ,1.5 ,0.2 ,setosa 5.0 ,3.6 ,1.4 ,0.2 ,setosa ... これはIris flower data setからの抜粋です。 データセットのコピーはここから見つける事ができます。
 種別以外のすべての値を含むテンソルを作成します。
gotaを使用してデータフレームを作成する gotaのデータフレームパッケージにはio.Readerを引数として取る関数ReadCSVがあります。
f, err := os.Open("iris.csv") if err != nil { log.Fatal(err) } defer f.'><meta property=og:type content=article><meta property=og:url content=https://gorgonia.org/ja/how-to/dataframe/><meta property=og:image content=https://gorgonia.org/images/opengraph.png><meta property=article:published_time content=2019-10-30T22:57:09+01:00><meta property=article:modified_time content=2019-10-30T22:57:09+01:00><meta property=og:site_name content=Gorgonia><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=https://gorgonia.org/images/opengraph.png><meta name=twitter:title content="データフレームからテンソルを作成 (gota)"><meta name=twitter:description content='このハウツーでは、gotaを使用してデータフレームからテンソルを作成する方法を説明します。 The goal is to read a csv file and create a *tensor.Dense with shape (2,2). ゴールは、csvファイルを読み取り、(2,2) のシェイプの* tensor.Denseを作成することです。
csvファイルからデータフレームを作成する 以下のコンテンツのcsvファイルを考えます:
sepal_length,sepal_width,petal_length,petal_width,species 5.1 ,3.5 ,1.4 ,0.2 ,setosa 4.9 ,3.0 ,1.4 ,0.2 ,setosa 4.7 ,3.2 ,1.3 ,0.2 ,setosa 4.6 ,3.1 ,1.5 ,0.2 ,setosa 5.0 ,3.6 ,1.4 ,0.2 ,setosa ... これはIris flower data setからの抜粋です。 データセットのコピーはここから見つける事ができます。
 種別以外のすべての値を含むテンソルを作成します。
gotaを使用してデータフレームを作成する gotaのデータフレームパッケージにはio.Readerを引数として取る関数ReadCSVがあります。
f, err := os.Open("iris.csv") if err != nil { log.Fatal(err) } defer f.'></head><body data-url=/ja/how-to/dataframe/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://gorgonia.org/><img src=https://gorgonia.org/images/logo/gorgonia.svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=検索...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1677767296></script><script type=text/javascript src=/js/auto-complete.js?1677767296></script><script type=text/javascript>var baseurl="https:\/\/gorgonia.org\/\/ja";</script><script type=text/javascript src=/js/search.js?1677767296></script><ul><li><a class=padding><em class="fas fa-language fa-fw"></em><div class=select-style><select id=select-language onchange="location=this.value;">
<option id=en value=https://gorgonia.org/how-to/dataframe/>English</option>
<option id=fr value=https://gorgonia.org/fr/how-to/dataframe/>Français</option>
<option id=ja value=https://gorgonia.org/ja/how-to/dataframe/ selected>Japanese</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><path d="M0 63.75l127.5 127.5L255 63.75z" /></g></g></svg></div></a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/ja/getting-started/ title=事始め class=dd-item><a href=/ja/getting-started/>事始め
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/ja/getting-started/ubiquitous-language/ title=普遍的な用語集 class=dd-item><a href=/ja/getting-started/ubiquitous-language/>普遍的な用語集
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/getting-started/contributing-doc/ title=ドキュメントへの貢献を始める class=dd-item><a href=/ja/getting-started/contributing-doc/>ドキュメントへの貢献を始める
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/ja/about/ title=Gorgoniaの仕組み class=dd-item><a href=/ja/about/>Gorgoniaの仕組み
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/ja/about/computation-graph/ title=計算グラフ class=dd-item><a href=/ja/about/computation-graph/>計算グラフ
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/about/differentiation/ title=微分 class=dd-item><a href=/ja/about/differentiation/>微分
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/ja/about/differentiation/symbolicdiff/ title=数式微分 class=dd-item><a href=/ja/about/differentiation/symbolicdiff/>数式微分
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/about/differentiation/autodiff/ title=自動微分 class=dd-item><a href=/ja/about/differentiation/autodiff/>自動微分
<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/ja/tutorials/ title=チュートリアル class=dd-item><a href=/ja/tutorials/>チュートリアル
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/ja/tutorials/hello-world/ title=こんにちわ世界 class=dd-item><a href=/ja/tutorials/hello-world/>こんにちわ世界
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/tutorials/mnist/ title="簡単なニューラルネットの構築 (MNIST)" class=dd-item><a href=/ja/tutorials/mnist/>簡単なニューラルネットの構築 (MNIST)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/tutorials/iris/ title="Iris データセットでの多変量線形回帰" class=dd-item><a href=/ja/tutorials/iris/>Iris データセットでの多変量線形回帰
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/ja/how-to/ title=ハウツー class="dd-item
        parent"><a href=/ja/how-to/>ハウツー
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/ja/how-to/dot/ title="Graphviz (dot) を用いた ExprGraph の描画" class=dd-item><a href=/ja/how-to/dot/>Graphviz (dot) を用いた ExprGraph の描画
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/how-to/dataframe/ title="データフレームからテンソルを作成 (gota)" class="dd-item active"><a href=/ja/how-to/dataframe/>データフレームからテンソルを作成 (gota)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/how-to/save-weights/ title=Weightsの保存 class=dd-item><a href=/ja/how-to/save-weights/>Weightsの保存
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/ja/reference/ title=リファレンスガイド class=dd-item><a href=/ja/reference/>リファレンスガイド
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/ja/reference/exprgraph/ title="グラフと Exprgraph" class=dd-item><a href=/ja/reference/exprgraph/>グラフと Exprgraph
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/reference/present/ title=発表 class=dd-item><a href=/ja/reference/present/>発表
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/reference/tensor/ title=Tensor class=dd-item><a href=/ja/reference/tensor/>Tensor
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/reference/solver/ title=Solvers class=dd-item><a href=/ja/reference/solver/>Solvers
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/reference/vm/ title=VM class=dd-item><a href=/ja/reference/vm/>VM
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/ja/reference/vm/lispmachine/ title=LispMachine class=dd-item><a href=/ja/reference/vm/lispmachine/>LispMachine
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/ja/reference/vm/tapemachine/ title=Tapemachine class=dd-item><a href=/ja/reference/vm/tapemachine/>Tapemachine
<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/ja/misc/ title=その他 class=dd-item><a href=/ja/misc/>その他
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>更に</h3><ul><li><a class=padding href=https://github.com/gorgonia/gorgonia><i class="fab fa-fw fa-github"></i>GitHub</a></li><li><a class=padding href="https://pkg.go.dev/gorgonia.org/gorgonia?tab=doc"><i class="fas fa-fw fa-bookmark"></i>API Doc</a></li><li><a class=padding href=http://gophers.slack.com/messages/gorgonia><i class="fab fa-fw fa-slack"></i>Contact us</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i>履歴削除</a></li></ul></section><section id=footer><center><a class=github-button href=https://github.com/gorgonia/gorgonia data-icon=octicon-star data-show-count=true aria-label="Star gorgonia/gorgonia on GitHub">Star</a><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></center><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title=このページを編集 href=https://github.com/gorgonia/gorgonia.github.io/edit/develop/content/how-to/dataframe.ja.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>このページを編集</span></a></div><div id=breadcrumbs itemscope itemtype=http://schema.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/ja/>main</a> > <a href=/ja/how-to/>ハウツー</a> > データフレームからテンソルを作成 (gota)</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#csvファイルからデータフレームを作成する>csvファイルからデータフレームを作成する</a></li><li><a href=#gotaを使用してデータフレームを作成する>gotaを使用してデータフレームを作成する</a></li><li><a href=#データフレームを行列に変換する>データフレームを行列に変換する</a></li><li><a href=#テンソルを作る>テンソルを作る</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>データフレームからテンソルを作成 (gota)</h1><p>このハウツーでは、<a href=https://github.com/go-gota/gota>gota</a>を使用してデータフレームからテンソルを作成する方法を説明します。
The goal is to read a csv file and create a <a href=https://godoc.org/gorgonia.org/tensor#Dense><code>*tensor.Dense</code></a> with shape (2,2).
ゴールは、csvファイルを読み取り、(2,2) のシェイプの<a href=https://godoc.org/gorgonia.org/tensor#Dense><code>* tensor.Dense</code></a>を作成することです。</p><h2 id=csvファイルからデータフレームを作成する>csvファイルからデータフレームを作成する</h2><p>以下のコンテンツのcsvファイルを考えます:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>sepal_length,sepal_width,petal_length,petal_width,species
5.1         ,3.5        ,1.4         ,0.2        ,setosa
4.9         ,3.0        ,1.4         ,0.2        ,setosa
4.7         ,3.2        ,1.3         ,0.2        ,setosa
4.6         ,3.1        ,1.5         ,0.2        ,setosa
5.0         ,3.6        ,1.4         ,0.2        ,setosa
...</code></pre></div><div class="notices info"><p>これは<a href=https://en.wikipedia.org/wiki/Iris_flower_data_set>Iris flower data set</a>からの抜粋です。
データセットのコピーは<a href=https://gist.github.com/owulveryck/19a5ba9553ff8209b3b4227b5325041b#file-iris-csv>ここ</a>から見つける事ができます。</p></div><p>種別以外のすべての値を含むテンソルを作成します。</p><h2 id=gotaを使用してデータフレームを作成する>gotaを使用してデータフレームを作成する</h2><p>gotaのデータフレームパッケージにはio.Readerを引数として取る関数<a href=https://godoc.org/github.com/kniren/gota/dataframe#ReadCSV><code>ReadCSV</code></a>があります。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>f</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Open</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;iris.csv&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
<span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>f</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>df</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>dataframe</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ReadCSV</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>f</span><span style=color:#000;font-weight:700>)</span></code></pre></div><p><code>df</code>がファイルに存在する全てのデータが含まれる<a href=https://godoc.org/github.com/kniren/gota/dataframe#DataFrame><code>DataFrame</code></a>です。</p><div class="notices info"><p>gotaはデータフレームの列を参照する為にCSVの最初の行を使用します。</p></div><p>種別(species)カラムを削除しましょう:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>xDF</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>df</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Drop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;species&#34;</span><span style=color:#000;font-weight:700>)</span></code></pre></div><h2 id=データフレームを行列に変換する>データフレームを行列に変換する</h2><p>物事を簡単にするために、データフレームをgonumで定義されている<code>Matrix</code>に変換します(<a href=https://godoc.org/gonum.org/v1/gonum/mat#Matrix>matrixのgodoc</a>を参照)。
<code>matrix</code>はインタフェースです。gotaのデータフレームは<code>Matrix</code>インターフェイスを満たしません。gotaのドキュメントに記載されているように、
<code>Matrix</code>インターフェイスを満たすために、データフレームのラッパーを作成します。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>matrix</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
	<span style=color:#000>dataframe</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DataFrame</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>m</span> <span style=color:#000>matrix</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>At</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>j</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>float64</span> <span style=color:#000;font-weight:700>{</span>
	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Elem</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>j</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>Float</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>m</span> <span style=color:#000>matrix</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>T</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000>mat</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Matrix</span> <span style=color:#000;font-weight:700>{</span>
	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>mat</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Transpose</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>Matrix</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>m</span><span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><h2 id=テンソルを作る>テンソルを作る</h2><p>データフレームを<code>matrix</code>構造体の中にラッピングすると関数<a href=https://godoc.org/gorgonia.org/tensor#FromMat64><code>tensor.FromMat64</code></a>のおかげで<code>*Dense</code>テンソルを作成できるようになります。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>xT</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>tensor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>FromMat64</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>mat</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DenseCopyOf</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>matrix</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>xDF</span><span style=color:#000;font-weight:700>}))</span></code></pre></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/ja/how-to/dot/ title="Graphviz (dot) を用いた ExprGraph の描画"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/ja/how-to/save-weights/ title=Weightsの保存 style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1677767296></script><script src=/js/perfect-scrollbar.min.js?1677767296></script><script src=/js/perfect-scrollbar.jquery.min.js?1677767296></script><script src=/js/jquery.sticky.js?1677767296></script><script src=/js/featherlight.min.js?1677767296></script><script src=/js/modernizr.custom-3.6.0.js?1677767296></script><script src=/js/learn.js?1677767296></script><script src=/js/hugo-learn.js?1677767296></script><link href=/mermaid/mermaid.css?1677767296 rel=stylesheet><script src=/mermaid/mermaid.js?1677767296></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>